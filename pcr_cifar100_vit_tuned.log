Namespace(num_runs=1, seed=0, val_size=0.1, num_val=3, num_runs_val=3, error_analysis=False, verbose=True, store=False, save_path=None, agent='PCR', update='random', retrieve='random', optimizer='Adam', learning_rate=0.0001, epoch=1, batch=4, test_batch=128, weight_decay=0.0001, num_tasks=10, fix_order=True, plot_sample=False, data='cifar100', cl_type='nc', ns_factor=(0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6), ns_type='noise', ns_task=(1, 1, 2, 2, 2, 2), online=True, mem_size=200, eps_mem_batch=10, lambda_=100, alpha=0.9, fisher_update_after=50, subsample=50, gss_mem_strength=10, gss_batch_size=10, k=5, aser_type='asvm', n_smp_cls=2.0, stm_capacity=1000, classifier_chill=0.01, log_alpha=-300, minlr=0.0005, clip=10.0, mem_epoch=70, labels_trick=False, separated_softmax=False, kd_trick=False, kd_trick_star=False, review_trick=False, ncm_trick=False, mem_iters=1, min_delta=0.0, patience=0, cumulative_delta=False, temp=0.07, buffer_tracker=False, warmup=4, head='mlp', cuda=True)
Setting up data stream
Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to ./datasets/cifar100/cifar-100-python.tar.gz
  0%|          | 0/169001437 [00:00<?, ?it/s]  0%|          | 98304/169001437 [00:00<03:24, 824831.68it/s]  0%|          | 688128/169001437 [00:00<00:47, 3579886.15it/s]  1%|          | 1933312/169001437 [00:00<00:22, 7389387.13it/s]  2%|▏         | 3178496/169001437 [00:00<00:17, 9216527.53it/s]  3%|▎         | 4456448/169001437 [00:00<00:15, 10452920.51it/s]  3%|▎         | 5734400/169001437 [00:00<00:14, 11147871.16it/s]  4%|▍         | 7045120/169001437 [00:00<00:13, 11740978.47it/s]  5%|▍         | 8355840/169001437 [00:00<00:13, 12040819.98it/s]  6%|▌         | 9764864/169001437 [00:00<00:12, 12548418.67it/s]  7%|▋         | 11108352/169001437 [00:01<00:12, 12771871.78it/s]  7%|▋         | 12484608/169001437 [00:01<00:12, 13015788.33it/s]  8%|▊         | 13828096/169001437 [00:01<00:11, 13131472.51it/s]  9%|▉         | 15237120/169001437 [00:01<00:11, 13353020.38it/s] 10%|▉         | 16646144/169001437 [00:01<00:11, 13549314.41it/s] 11%|█         | 18087936/169001437 [00:01<00:10, 13735740.34it/s] 12%|█▏        | 19529728/169001437 [00:01<00:10, 13870126.32it/s] 12%|█▏        | 21037056/169001437 [00:01<00:10, 14139604.24it/s] 13%|█▎        | 22544384/169001437 [00:01<00:10, 14343693.01it/s] 14%|█▍        | 24051712/169001437 [00:01<00:09, 14511087.64it/s] 15%|█▌        | 25591808/169001437 [00:02<00:09, 14676056.54it/s] 16%|█▌        | 27099136/169001437 [00:02<00:09, 14766322.68it/s] 17%|█▋        | 28639232/169001437 [00:02<00:09, 14927798.23it/s] 18%|█▊        | 30146560/169001437 [00:02<00:09, 14895136.91it/s] 19%|█▉        | 31719424/169001437 [00:02<00:09, 15117049.64it/s] 20%|█▉        | 33325056/169001437 [00:02<00:08, 15295632.42it/s] 21%|██        | 34897920/169001437 [00:02<00:08, 15389118.13it/s] 22%|██▏       | 36503552/169001437 [00:02<00:08, 15484355.85it/s] 23%|██▎       | 38076416/169001437 [00:02<00:08, 15511368.57it/s] 23%|██▎       | 39682048/169001437 [00:02<00:08, 15637135.22it/s] 24%|██▍       | 41320448/169001437 [00:03<00:08, 15785911.45it/s] 25%|██▌       | 42926080/169001437 [00:03<00:07, 15814999.15it/s] 26%|██▋       | 44531712/169001437 [00:03<00:07, 15882474.81it/s] 27%|██▋       | 46137344/169001437 [00:03<00:07, 15912354.38it/s] 28%|██▊       | 47775744/169001437 [00:03<00:07, 16025336.80it/s] 29%|██▉       | 49414144/169001437 [00:03<00:07, 16045934.55it/s] 30%|███       | 51118080/169001437 [00:03<00:07, 16270116.08it/s] 31%|███       | 52756480/169001437 [00:03<00:07, 16192349.40it/s] 32%|███▏      | 54394880/169001437 [00:03<00:07, 16196858.43it/s] 33%|███▎      | 56131584/169001437 [00:03<00:06, 16477077.43it/s] 34%|███▍      | 57802752/169001437 [00:04<00:06, 16460673.90it/s] 35%|███▌      | 59473920/169001437 [00:04<00:06, 16452005.06it/s] 36%|███▌      | 61145088/169001437 [00:04<00:06, 16477169.08it/s] 37%|███▋      | 62849024/169001437 [00:04<00:06, 16629530.99it/s] 38%|███▊      | 64520192/169001437 [00:04<00:06, 16537440.55it/s] 39%|███▉      | 66191360/169001437 [00:04<00:06, 16538018.85it/s] 40%|████      | 67895296/169001437 [00:04<00:06, 16678510.29it/s] 41%|████      | 69599232/169001437 [00:04<00:05, 16704224.20it/s] 42%|████▏     | 71303168/169001437 [00:04<00:05, 16765670.98it/s] 43%|████▎     | 73007104/169001437 [00:04<00:05, 16793143.20it/s] 44%|████▍     | 74711040/169001437 [00:05<00:05, 16773377.91it/s] 45%|████▌     | 76447744/169001437 [00:05<00:05, 16879128.39it/s] 46%|████▌     | 78151680/169001437 [00:05<00:05, 16734752.95it/s] 47%|████▋     | 79888384/169001437 [00:05<00:05, 16818558.50it/s] 48%|████▊     | 81592320/169001437 [00:05<00:05, 16808854.35it/s] 49%|████▉     | 83296256/169001437 [00:05<00:05, 16861661.02it/s] 50%|█████     | 85000192/169001437 [00:05<00:04, 16834251.95it/s] 51%|█████▏    | 86704128/169001437 [00:05<00:04, 16872868.41it/s] 52%|█████▏    | 88408064/169001437 [00:05<00:04, 16823934.50it/s] 53%|█████▎    | 90144768/169001437 [00:06<00:04, 16865028.89it/s] 54%|█████▍    | 91914240/169001437 [00:06<00:04, 17005899.13it/s] 55%|█████▌    | 93650944/169001437 [00:06<00:04, 17055966.14it/s] 56%|█████▋    | 95420416/169001437 [00:06<00:04, 17156888.01it/s] 57%|█████▋    | 97157120/169001437 [00:06<00:04, 17151618.72it/s] 59%|█████▊    | 98926592/169001437 [00:06<00:04, 17240025.35it/s] 60%|█████▉    | 100663296/169001437 [00:06<00:03, 17174596.66it/s] 61%|██████    | 102432768/169001437 [00:06<00:03, 17215969.72it/s] 62%|██████▏   | 104169472/169001437 [00:06<00:03, 17122929.98it/s] 63%|██████▎   | 105938944/169001437 [00:06<00:03, 17245031.74it/s] 64%|██████▎   | 107675648/169001437 [00:07<00:03, 17277730.40it/s] 65%|██████▍   | 109412352/169001437 [00:07<00:03, 17254610.36it/s] 66%|██████▌   | 111149056/169001437 [00:07<00:03, 17207762.55it/s] 67%|██████▋   | 112918528/169001437 [00:07<00:03, 17313379.00it/s] 68%|██████▊   | 114655232/169001437 [00:07<00:03, 17211997.08it/s] 69%|██████▉   | 116391936/169001437 [00:07<00:03, 17162696.36it/s] 70%|██████▉   | 118128640/169001437 [00:07<00:02, 17192316.81it/s] 71%|███████   | 119930880/169001437 [00:07<00:02, 17328693.91it/s] 72%|███████▏  | 121667584/169001437 [00:07<00:02, 17264475.17it/s] 73%|███████▎  | 123404288/169001437 [00:07<00:02, 16986251.51it/s] 74%|███████▍  | 125108224/169001437 [00:08<00:02, 16990282.62it/s] 75%|███████▌  | 126812160/169001437 [00:08<00:02, 16987685.82it/s] 76%|███████▌  | 128548864/169001437 [00:08<00:02, 17054359.74it/s] 77%|███████▋  | 130285568/169001437 [00:08<00:02, 17123183.01it/s] 78%|███████▊  | 132022272/169001437 [00:08<00:02, 16779914.96it/s] 79%|███████▉  | 133758976/169001437 [00:08<00:02, 16860216.16it/s] 80%|████████  | 135528448/169001437 [00:08<00:01, 16999472.79it/s] 81%|████████  | 137265152/169001437 [00:08<00:01, 17072909.27it/s] 82%|████████▏ | 139001856/169001437 [00:08<00:01, 17090010.49it/s] 83%|████████▎ | 140771328/169001437 [00:08<00:01, 17250461.34it/s] 84%|████████▍ | 142508032/169001437 [00:09<00:01, 17232772.81it/s] 85%|████████▌ | 144277504/169001437 [00:09<00:01, 17307051.30it/s] 86%|████████▋ | 146079744/169001437 [00:09<00:01, 17423077.11it/s] 87%|████████▋ | 147849216/169001437 [00:09<00:01, 17401475.62it/s] 89%|████████▊ | 149618688/169001437 [00:09<00:01, 17436049.54it/s] 90%|████████▉ | 151388160/169001437 [00:09<00:01, 17262173.72it/s] 91%|█████████ | 153157632/169001437 [00:09<00:00, 17295131.23it/s] 92%|█████████▏| 154894336/169001437 [00:09<00:00, 16955954.94it/s] 93%|█████████▎| 156598272/169001437 [00:09<00:00, 16840673.88it/s] 94%|█████████▍| 158466048/169001437 [00:09<00:00, 17298887.37it/s] 95%|█████████▍| 160268288/169001437 [00:10<00:00, 17388492.63it/s] 96%|█████████▌| 162103296/169001437 [00:10<00:00, 17627127.40it/s] 97%|█████████▋| 163971072/169001437 [00:10<00:00, 17905125.27it/s] 98%|█████████▊| 165773312/169001437 [00:10<00:00, 17887921.48it/s] 99%|█████████▉| 167673856/169001437 [00:10<00:00, 18152534.32it/s]100%|██████████| 169001437/169001437 [00:10<00:00, 16006692.30it/s]
/home/christina/anaconda3/envs/lora_vit/lib/python3.11/site-packages/numpy/core/_methods.py:206: RuntimeWarning: Degrees of freedom <= 0 for slice
  ret = _var(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/home/christina/anaconda3/envs/lora_vit/lib/python3.11/site-packages/numpy/core/_methods.py:198: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)
Extracting ./datasets/cifar100/cifar-100-python.tar.gz to ./datasets/cifar100
Files already downloaded and verified
data setup time: 13.05514144897461
Task: 0, Labels:[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
Task: 1, Labels:[10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Task: 2, Labels:[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Task: 3, Labels:[30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Task: 4, Labels:[40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Task: 5, Labels:[50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Task: 6, Labels:[60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Task: 7, Labels:[70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Task: 8, Labels:[80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Task: 9, Labels:[90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
buffer has 200 slots
-----------run 0 training batch 0-------------
size: (5000, 32, 32, 3), (5000,)
[0.913 0.    0.    0.001 0.    0.    0.    0.    0.    0.   ]
-----------run 0 training batch 1-------------
size: (5000, 32, 32, 3), (5000,)
[0.524 0.868 0.    0.    0.    0.    0.    0.    0.    0.   ]
-----------run 0 training batch 2-------------
size: (5000, 32, 32, 3), (5000,)
[0.495 0.403 0.825 0.    0.    0.    0.    0.    0.    0.   ]
-----------run 0 training batch 3-------------
size: (5000, 32, 32, 3), (5000,)
[0.338 0.256 0.521 0.852 0.    0.    0.    0.    0.    0.   ]
-----------run 0 training batch 4-------------
size: (5000, 32, 32, 3), (5000,)
[0.26  0.156 0.205 0.298 0.872 0.    0.    0.    0.    0.   ]
-----------run 0 training batch 5-------------
size: (5000, 32, 32, 3), (5000,)
[0.238 0.106 0.261 0.123 0.412 0.802 0.    0.    0.    0.   ]
-----------run 0 training batch 6-------------
size: (5000, 32, 32, 3), (5000,)
[0.299 0.118 0.191 0.101 0.184 0.338 0.795 0.    0.    0.   ]
-----------run 0 training batch 7-------------
size: (5000, 32, 32, 3), (5000,)
[0.119 0.068 0.124 0.112 0.067 0.258 0.218 0.819 0.    0.   ]
-----------run 0 training batch 8-------------
size: (5000, 32, 32, 3), (5000,)
[0.151 0.025 0.144 0.062 0.114 0.203 0.273 0.285 0.824 0.   ]
-----------run 0 training batch 9-------------
size: (5000, 32, 32, 3), (5000,)
[0.132 0.061 0.127 0.034 0.088 0.069 0.145 0.126 0.226 0.853]
-----------run 0-----------avg_end_acc 0.1861-----------train time 3785.2843952178955
----------- Total 1 run: 3798.3395948410034s -----------
----------- Avg_End_Acc (0.1861, nan) Avg_End_Fgt (0.6562, nan) Avg_Acc (0.42868257936507936, nan) Avg_Bwtp (0.0, nan) Avg_Fwt (2.2222222222222223e-05, nan)-----------
